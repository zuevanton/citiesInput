'use strict';class CitiesInput  { constructor() {   this.data = data;   this.input = document.getElementById('select-cities');   this.locale = 'RU';   this.arrOfCountries = this.getArrOfCountries(this.locale);   this.dropdownDefault = document.querySelector('.dropdown-lists__list--default > .dropdown-lists__col');   this.dropdownSelect = document.querySelector('.dropdown-lists__list--select > .dropdown-lists__col');   this.dropdownDefaultWrap = document.querySelector('.dropdown-lists__list--default');   this.dropdownSelectWrap = document.querySelector('.dropdown-lists__list--select');   this.dropdownAutocomplete = document.querySelector('.dropdown-lists__list--autocomplete > .dropdown-lists__col');   this.dropdownAutocompleteWrap = document.querySelector('.dropdown-lists__list--autocomplete');   this.button = document.querySelector('.button');   this.label = document.querySelector('.label');   this.closeBtn = document.querySelector('.close-button');   this.dropdown = document.querySelector('.dropdown'); } getArrOfCountries (){   return this.data[this.locale]; } createDefaultList(arr) {   this.dropdownDefault.innerHTML = '';   this.dropdownDefaultWrap.style.display = '';   return arr.map(country => {     // создаем обертку     const countryBlock = document.createElement('div');     countryBlock.classList.add('dropdown-lists__countryBlock');     this.dropdownDefault.insertAdjacentElement('afterbegin', countryBlock);     // создаем верхнюю строку со страной     const totalLine = document.createElement('div'),           totalLineCountry = document.createElement('div'),           countryCount = document.createElement('div');     totalLine.classList.add('dropdown-lists__total-line');     totalLineCountry.classList.add('dropdown-lists__country');     totalLineCountry.textContent = country.country;     totalLine.addEventListener('click', (e)=> {       this.createSelectList(e);     });     totalLine.insertAdjacentElement('beforeend', totalLineCountry);     countryCount.classList.add('dropdown-lists__count');     countryCount.textContent = country.count;     totalLine.insertAdjacentElement('beforeend', countryCount);     countryBlock.insertAdjacentElement('beforeend', totalLine);     // создаем линии с городами     for(let i = 0; i < 3; i++){       const line = document.createElement('div');       line.classList.add('dropdown-lists__line');       const city = document.createElement('div');       city.classList.add('dropdown-lists__city');       city.textContent = country.cities[i].name;       line.insertAdjacentElement('beforeend', city);       const count = document.createElement('div');       count.classList.add('dropdown-lists__count');       count.textContent = country.cities[i].count;       line.insertAdjacentElement('beforeend', count);       countryBlock.insertAdjacentElement('beforeend', line);     }     return countryBlock;   }); } createSelectList(e) {   const selectedCountryName = e.target.closest('.dropdown-lists__total-line').childNodes[0].textContent;   this.dropdownDefaultWrap.style.display = 'none';   let selectedCountry = this.getArrOfCountries().filter(item => item.country === selectedCountryName)[0];   this.dropdownSelectWrap.style.display = 'block';   this.dropdownSelect.innerHTML = '';   // создаем обертку   const countryBlock = document.createElement('div');   countryBlock.classList.add('dropdown-lists__countryBlock');   this.dropdownSelect.insertAdjacentElement('afterbegin', countryBlock);   // создаем верхнюю строку со страной   const totalLine = document.createElement('div'),     totalLineCountry = document.createElement('div'),     countryCount = document.createElement('div');   totalLine.classList.add('dropdown-lists__total-line');   totalLineCountry.classList.add('dropdown-lists__country');   totalLineCountry.textContent = selectedCountry.country;   totalLine.addEventListener('click', (e)=> {     this.dropdownSelectWrap.style.display = 'none';     this.dropdownDefaultWrap.style.display = 'block';     this.createDefaultList(this.getArrOfCountries());   });   totalLine.insertAdjacentElement('beforeend', totalLineCountry);   countryCount.classList.add('dropdown-lists__count');   countryCount.textContent = selectedCountry.count;   totalLine.insertAdjacentElement('beforeend', countryCount);   countryBlock.insertAdjacentElement('beforeend', totalLine);   // создаем линии с городами   for(let i = 0; i < selectedCountry.cities.length; i++){     const line = document.createElement('div');     line.classList.add('dropdown-lists__line');     const city = document.createElement('div');     city.classList.add('dropdown-lists__city');     city.textContent = selectedCountry.cities[i].name;     line.insertAdjacentElement('beforeend', city);     const count = document.createElement('div');     count.classList.add('dropdown-lists__count');     count.textContent = selectedCountry.cities[i].count;     line.insertAdjacentElement('beforeend', count);     countryBlock.insertAdjacentElement('beforeend', line);   } } createAutoCompletedList(e){   const text = this.input.value,         search = `/^${text}/i`;   if(!text){     this.dropdownDefaultWrap.style.display = 'block';     this.dropdownAutocompleteWrap.style.display = 'none';     return;   }   this.dropdownDefaultWrap.style.display = 'none';   this.dropdownSelectWrap.style.display = 'none';   this.dropdownAutocompleteWrap.style.display = 'block';   let allCities = [];   this.arrOfCountries.forEach(country => {     country.cities.forEach(city => allCities.push(city.name));   });   this.dropdownAutocomplete.innerHTML = '';   const foundedCities = allCities.filter(city => city.match(eval(search)));   const countryBlock = document.createElement('div');   countryBlock.classList.add('dropdown-lists__countryBlock');   this.dropdownAutocomplete.insertAdjacentElement('afterbegin', countryBlock);   foundedCities.forEach(item => {     const line = document.createElement('div');     line.classList.add('dropdown-lists__line');     const city = document.createElement('div');     city.classList.add('dropdown-lists__city');     city.textContent = item;     line.insertAdjacentElement('beforeend', city);     let countValue = '';     this.arrOfCountries.forEach(country => {       country.cities.forEach(city => {         if(city.name === item){           countValue = city.count;         }       });     });     const count = document.createElement('div');     count.classList.add('dropdown-lists__count');     count.textContent = countValue;     line.insertAdjacentElement('beforeend', count);     countryBlock.insertAdjacentElement('beforeend', line);   });   if(!allCities.filter(city => city.match(eval(search))).length){     countryBlock.textContent = 'ничего не найдено';   } } createInputValue(){   this.dropdown.addEventListener('click', (e) => {     const target = e.target;     this.label.style.display = 'none';     this.closeBtn.style.display = 'block';     if(!target.closest('.dropdown-lists__country') && !target.closest('.dropdown-lists__city')){       return     }     if(target.closest('.dropdown-lists__total-line')){       this.input.value = target.closest('.dropdown-lists__country').textContent;     } else if (target.closest('.dropdown-lists__line')){       this.input.value = target.closest('.dropdown-lists__city').textContent;       let link = '';       this.arrOfCountries.forEach(country => {         country.cities.forEach(city => {           if(city.name === this.input.value){             link = city.link;           }         });       });      this.activateButton(link);     }   });   this.closeBtn.addEventListener('click', (e) => {     this.label.style.display = '';     this.closeBtn.style.display = 'none';     this.input.value = '';     this.dropdownSelectWrap.style.display = 'none';     this.dropdownDefaultWrap.style.display = 'none';     this.dropdownAutocompleteWrap.style.display = 'none';     this.blockButton(e);   }); } blockButton(e){   this.button.href = '';   e.preventDefault(); } activateButton(link){   this.button.href = link; } init(){   this.input.addEventListener('focus', () => {     if(this.input.value){       return     }     if(this.dropdownDefaultWrap.style.display !== 'none') {       this.dropdownDefaultWrap.style.display = 'block';     }     this.createDefaultList(this.getArrOfCountries());   });   this.button.addEventListener('click', (e) => this.blockButton(e));   this.input.addEventListener('input', (e) => {     this.createAutoCompletedList(e);     if(!this.input.value){       this.dropdownSelectWrap.style.display = 'none';       this.dropdownAutocompleteWrap.style.display = 'none';       this.closeBtn.style.display = 'none';       this.blockButton(e);     }   });   this.createInputValue(); }}const citiesInput = new CitiesInput();citiesInput.init();